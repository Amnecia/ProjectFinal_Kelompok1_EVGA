{% include 'header.html' %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Serif+Display:ital,wght@0,100..900;1,100..900&family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Satisfy&family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&display=swap"
        rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.7.1.js"
        integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <link href="../static/assets/mystyle.css" rel="stylesheet">
    <style>
   /* Make the carousel responsive */
.carousel {
    width: 100%;
    height: 75vh; /* Set a fixed height for the carousel */
}

.carousel-inner {
    height: 100%;
}

.carousel-item {
    height: 100%;
}

.carousel-item img {
    width: 100%;
    height: 100vh; /* Set a fixed height for all images */
    object-fit: cover;
}

/* Add media queries to make the carousel responsive */
@media (max-width: 768px) {
   .carousel {
        height: 50vh; /* Reduce the height of the carousel on smaller screens */
    }
}

@media (max-width: 480px) {
   .carousel {
        height: 30vh; /* Reduce the height of the carousel on even smaller screens */
    }
}

/* Make the product info section responsive */
.product-info {
    flex-direction: column; /* Make the product info section a column on smaller screens */
}

@media (max-width: 768px) {
   .product-info {
        padding: 20px; /* Add padding to the product info section on smaller screens */
    }
}

@media (max-width: 480px) {
   .product-info {
        padding: 10px; /* Reduce the padding on even smaller screens */
    }
}
    </style>
    <title>Edit Produk</title>
</head>

<body>
    <br>
    <br>
    <br>
    <br>
    <div class="container border border-danger shadow rounded p-3">
        <div class="row justify-content-center">
            <div id="imagePreview" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active" id="carousel-item-1">
                        <img src="{{ url_for('static', filename='assets/productImage/' + produk.image1) }}" class="d-block w-100" alt="First slide">
                    </div>
                    <div class="carousel-item" id="carousel-item-2">
                        <img src="{{ url_for('static', filename='assets/productImage/' + produk.image2) }}" class="d-block w-100" alt="Second slide">
                    </div>
                    <div class="carousel-item" id="carousel-item-3">
                        <img src="{{ url_for('static', filename='assets/productImage/' + produk.image3) }}" class="d-block w-100" alt="Third slide">
                    </div>
                    
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#imagePreview" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#imagePreview" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </div>
        <div class="row justify-content-center product-info product-info-left mt-4">
            <div class="col-9">
                <div class="mb-3">
                    <label for="namaProduk" class="form-label">Product Name</label>
                    <input type="text" class="form-control border border-dark" id="namaProduk"
                        value="{{ produk.nama }}">
                </div>
                <div class="mb-3">
                    <label for="hargaProduk" class="form-label">Price</label>
                    <input type="number" class="form-control border border-dark" id="hargaProduk"
                        value="{{ produk.harga }}">
                </div>
                <div class="mb-3 center-buttons">
                    <!-- Hidden input file, triggered by clicking the button -->
                    <input type="file" id="imageInput1" style="display: none;" accept="image/*">
                    <!-- Button to trigger file input -->
                    <label for="imageInput1" class="btn btn-danger">First Image</label>
                    <input type="file" id="imageInput2" style="display: none;" accept="image/*">
                    <!-- Button to trigger file input -->
                    <label for="imageInput2" class="btn btn-danger">Second Image</label>
                    <input type="file" id="imageInput3" style="display: none;" accept="image/*">
                    <!-- Button to trigger file input -->
                    <label for="imageInput3" class="btn btn-danger">Third Image</label>
                </div>
            </div>
            <div class="mb-4 mx-2" style="width: 97%;">
                <label for="deskripsiProduk" class="form-label">Description</label>
                <textarea class="form-control border border-dark" id="deskripsiProduk"
                    rows="4">{{ produk.deskripsi }}</textarea>
            </div>
        </div>
        <div class="row justify-content-between">
            <div class="col-9"></div>
            <div class="col-auto">
                <button type="button" class="btn btn-outline-danger mx-2 px-4">Cancel</button>
                <button type="button" class="btn btn-danger px-4"
                    onclick="updateProduk('{{ produk._id }}')">Save</button>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz4fnFO9gybBogGzqLAIpKLebJl6qk3S1Xp3Ez1Ft+rBZp6IZomDhBVGg4"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+Akv3PVGqYndWxANhw0Gz6EekpB0L5f9dx6xfELRVQvzZZ3h+x"
        crossorigin="anonymous"></script>
  <script>
function updateProduk(_id) {
    let nama = $('#namaProduk').val();
    let harga = $('#hargaProduk').val();
    let deskripsi = $('#deskripsiProduk').val();
    let image1 = $('#imageInput1')[0].files[0];
    let image2 = $('#imageInput2')[0].files[0];
    let image3 = $('#imageInput3')[0].files[0];

    let formData = new FormData();
    formData.append('nama', nama);
    formData.append('harga', harga);
    formData.append('deskripsi', deskripsi);
    formData.append('image1', image1);
    formData.append('image2', image2);
    formData.append('image3', image3);

    $.ajax({
        url: '/updateProduk/' + _id,
        type: 'POST',
        data: formData,
        contentType: false,
        processData: false,
        success: function(response) {
            alert("Produk Baru telah berhasil diupdate!");
            location.href = '/list';
        },
        error: function (error) {
            console.log(error);
            alert('Failed to update product');
        }
    });
}
$(document).ready(function () {
    $('#imageInput1').change(function (event) {
        var reader = new FileReader();
        reader.onload = function (event) {
            $('#imagePreview .carousel-item:nth-child(1) img').attr('src', event.target.result);
        }
        reader.readAsDataURL(event.target.files[0]);
    });

    $('#imageInput2').change(function (event) {
        var reader = new FileReader();
        reader.onload = function (event) {
            $('#imagePreview .carousel-item:nth-child(2) img').attr('src', event.target.result);
        }
        reader.readAsDataURL(event.target.files[0]);
    });

    $('#imageInput3').change(function (event) {
        var reader = new FileReader();
        reader.onload = function (event) {
            $('#imagePreview .carousel-item:nth-child(3) img').attr('src', event.target.result);
        }
        reader.readAsDataURL(event.target.files[0]);
    });
});

    </script>
</body>

</html>

{% include 'footer.html' %}